{% extends "staffs/base.html" %}
{% load django_bootstrap5 %}

{% block main %}
<h2>利用者一覧</h2>
<a href="{% url 'careusers:new' %}">{% bootstrap_button button_type="button" content="新規登録" %}</a>

{% if object_list %}
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>利用者名</th>
            <th colspan='3'>標準スケジュール</th>
        </tr>
    </thead>
    <tbody>
    {% for careuser in object_list %}
        <tr>
            <th>{{careuser.id}}</th>
            <th><a href="{% url 'careusers:edit' careuser.id %}">{{careuser.last_name}} {{careuser.first_name}}</a></th>
            <th>
                {% if careuser.defaultschedule_set.all|length > 0 %}
                <table class="table">
                    <tbody>
                        {% for sche in careuser.defaultschedule_set.all %}
                        <tr>
                            <th>{{ sche.get_schedule_name }}</th>
                            <th>{{ sche.get_schedule_time }}</th>
                            <th></th>
                            <th>{{ sche.biko }}</th>
                            <th></th>
                            <th><a href="{% url 'careusers:def_sche_edit' sche.pk %}">{% bootstrap_button button_type="button" content="変更" %}</a></th>
                        </tr> 
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                登録なし
                {% endif %}
            </th>
            <th><a href="{% url 'careusers:def_sche_new' careuser_id=careuser.id %}">{% bootstrap_button button_type="button" content="追加" %}</a></th>
        </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p>利用者は登録されておりません。</p>
{% endif %}
{% endblock %}